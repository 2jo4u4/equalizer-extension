(()=>{"use strict";var e={5243:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.name_dialog=t.select_input=t.auto_connect_btn=t.tabs_setting_container=t.tabs_setting=t.tabs_help_container=t.tabs_help=t.tabs_board_container=t.tabs_board=t.tabs=void 0;const n=document.querySelector("#tabs");t.tabs=n;const[i,a,r]=n.querySelectorAll("md-primary-tab");t.tabs_board=i,t.tabs_help=a,t.tabs_setting=r;const o=document.querySelector("#board-panel");t.tabs_board_container=o;const s=document.querySelector("#help-panel");t.tabs_help_container=s;const u=document.querySelector("#setting-panel");t.tabs_setting_container=u;const c=document.querySelector("#auto-connect-media");t.auto_connect_btn=c;const l=document.createElement("select");t.select_input=l;const d=document.querySelector("md-dialog");t.name_dialog=d},5464:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,r){function o(e){try{u(i.next(e))}catch(e){r(e)}}function s(e){try{u(i.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.rerenderSelect=t.SliderArray=void 0;const a=n(2857),r=n(5243),o=[];t.SliderArray=o,function(){i(this,void 0,void 0,(function*(){const{mainEqaulizerSetting:e="default",usefulEqaulizerSetting:t=a.usefulFilfter,customEqaulizerSetting:n={}}=yield a.Store.getAll(),[s,u,c,l,d]=r.tabs_board_container.querySelectorAll("md-icon-button"),f=document.createElement("div");u.addEventListener("click",(function(){a.Store.getAll().then((({usefulEqaulizerSetting:e=a.usefulFilfter,customEqaulizerSetting:t={}})=>{const{filters:n}=e[r.select_input.value]||t[r.select_input.value];n.forEach(((e,t)=>{(0,a.sendMessageToCurrentTabs)("ctrl",{index:t,val:e.gain}),o[t].value=e.gain}))}))})),s.addEventListener("click",(function(){r.name_dialog.show()})),c.addEventListener("click",(function(){(0,a.sendMessageToCurrentTabs)("connect",null)})),l.addEventListener("click",(function(){(0,a.sendMessageToCurrentTabs)("setting-defalut",r.select_input.value)})),d.addEventListener("click",(function(){return i(this,void 0,void 0,(function*(){(0,a.sendMessageToCurrentTabs)("store-delete-custom",r.select_input.value)}))})),r.tabs_board_container.appendChild(f).append(r.name_dialog),r.tabs_board_container.append(r.select_input);const[h,p]=r.name_dialog.querySelectorAll(".footer > md-icon-button");h.addEventListener("click",(function(){r.name_dialog.close()})),p.addEventListener("click",(function(){const e=r.name_dialog.querySelector("md-filled-text-field");e.value&&((0,a.sendMessageToCurrentTabs)("store-setting",e.value),e.value="",r.name_dialog.close())})),Object.keys(t).forEach((e=>{const t=document.createElement("option");t.value=e,t.innerText=e,t.dataset.isCustom="0",r.select_input.append(t)})),Object.keys(n).forEach((e=>{const t=document.createElement("option");t.value=e,t.innerText=e,t.dataset.isCustom="1",r.select_input.append(t)})),r.select_input.value=e,r.select_input.addEventListener("change",(function(){a.Store.getAll().then((({usefulEqaulizerSetting:e=a.usefulFilfter,customEqaulizerSetting:t={}})=>{const n=Object.assign({},e,t)[r.select_input.value];n&&o.forEach(((e,t)=>{e.value=n.filters[t].gain,(0,a.sendMessageToCurrentTabs)("ctrl",{index:t,val:n.filters[t].gain})}))}))}));const{filters:g}=t[e]||n[e];g.forEach(((e,t)=>{const n=document.createElement("md-slider");n.step=.5,n.max=12,n.min=-12,n.value=e.gain,n.labeled=!0,n.addEventListener("input",(function(){void 0!==n.value&&(0,a.sendMessageToCurrentTabs)("ctrl",{index:t,val:n.value})}));const i=document.createElement("span");i.innerText=(0,a.hzToTitle)(e.hz);const s=document.createElement("div");r.tabs_board_container.appendChild(s).append(n,i),o.push(n)})),(0,a.sendMessageToCurrentTabs)("open",null)}))}(),t.rerenderSelect=function(e){return i(this,void 0,void 0,(function*(){var t;r.select_input.querySelectorAll("option").forEach((e=>{"1"===e.dataset.isCustom&&r.select_input.removeChild(e)}));const n=null!==(t=yield a.Store.get("customEqaulizerSetting"))&&void 0!==t?t:{};Object.keys(n).forEach((e=>{const t=document.createElement("option");t.value=e,t.innerText=e,t.dataset.isCustom="1",r.select_input.append(t)})),e&&(r.select_input.value=e)}))}},4595:()=>{},640:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,r){function o(e){try{u(i.next(e))}catch(e){r(e)}}function s(e){try{u(i.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const a=n(2857),r=n(5243);!function(){i(this,void 0,void 0,(function*(){r.auto_connect_btn.addEventListener("change",(function(){a.Store.set("autoConnectMedia",r.auto_connect_btn.selected?1:0)}))}))}()},8153:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,r){function o(e){try{u(i.next(e))}catch(e){r(e)}}function s(e){try{u(i.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const a=n(5243);!function(){i(this,void 0,void 0,(function*(){a.tabs.addEventListener("change",(function(){a.tabs_board_container.hidden=0!==a.tabs.activeTabIndex,a.tabs_help_container.hidden=1!==a.tabs.activeTabIndex,a.tabs_setting_container.hidden=2!==a.tabs.activeTabIndex}))}))}()},2237:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Equalizer=t.AudioContextWithMethod=void 0;class n{constructor(e){this.audioCtx=new AudioContext(e)}createBiquadFilter(){return this.audioCtx.createBiquadFilter()}allpass({f:e,g:t,q:n}){const i=this.createBiquadFilter();return i.type="allpass",i.frequency.value=e,i.Q.value=n,i}bandpass({f:e,g:t,q:n}){const i=this.createBiquadFilter();return i.type="bandpass",i.frequency.value=e,i.Q.value=n,i}highpass({f:e,g:t,q:n}){const i=this.createBiquadFilter();return i.type="highpass",i.frequency.value=e,i.Q.value=n,i}highshelf({f:e,g:t,q:n}){const i=this.createBiquadFilter();return i.type="highshelf",i.frequency.value=e,i.gain.value=t,i}lowpass({f:e,g:t,q:n}){const i=this.createBiquadFilter();return i.type="lowpass",i.frequency.value=e,i.Q.value=n,i}lowshelf({f:e,g:t,q:n}){const i=this.createBiquadFilter();return i.type="lowshelf",i.frequency.value=e,i.gain.value=t,i}notch({f:e,g:t,q:n}){const i=this.createBiquadFilter();return i.type="notch",i.frequency.value=e,i.Q.value=n,i}peaking({f:e,g:t,q:n}){const i=this.createBiquadFilter();return i.type="peaking",i.frequency.value=e,i.Q.value=n,i.gain.value=t,i}}t.AudioContextWithMethod=n,t.Equalizer=class{constructor(e){this.index=0,this.audio=new n,this.audioCtx=this.audio.audioCtx,this.queue=new Map,e&&(this.media=e),this.isStream=!1}addToQueue(e){this.index++;const t=this.index.toString();return this.queue.set(t,e),this}stream(e=this.media){if(!this.isStream&&e){this.media=e,this.source=this.audioCtx.createMediaElementSource(this.media);let t=this.source;this.queue.forEach((e=>{t.connect(e),t=e})),t.connect(this.audioCtx.destination),this.isStream=!0}}}},55:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.usefulFilfter=void 0,t.usefulFilfter={default:{isCustom:!1,filters:[{hz:60,gain:0,q:.7,type:"peaking"},{hz:230,gain:0,q:.7,type:"peaking"},{hz:910,gain:0,q:.7,type:"peaking"},{hz:4e3,gain:0,q:.7,type:"peaking"},{hz:14e3,gain:0,q:.7,type:"peaking"}]},"low-enhance":{isCustom:!1,filters:[{hz:60,gain:12,q:.7,type:"peaking"},{hz:230,gain:12,q:.7,type:"peaking"},{hz:910,gain:10,q:.7,type:"peaking"},{hz:4e3,gain:8,q:.7,type:"peaking"},{hz:14e3,gain:8,q:.7,type:"peaking"}]},"height-enhance":{isCustom:!1,filters:[{hz:60,gain:8,q:.7,type:"peaking"},{hz:230,gain:8,q:.7,type:"peaking"},{hz:910,gain:10,q:.7,type:"peaking"},{hz:4e3,gain:12,q:.7,type:"peaking"},{hz:14e3,gain:12,q:.7,type:"peaking"}]},"volume-enhance":{isCustom:!1,filters:[{hz:60,gain:8,q:.7,type:"peaking"},{hz:230,gain:8,q:.7,type:"peaking"},{hz:910,gain:10,q:.7,type:"peaking"},{hz:4e3,gain:12,q:.7,type:"peaking"},{hz:14e3,gain:12,q:.7,type:"peaking"}]}}},2857:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sendMessageToEuqalizer=t.sendMessageToCurrentTabs=t.getCurrentTabs=t.hzToTitle=t.Store=t.usefulFilfter=t.AudioContextWithMethod=t.Equalizer=void 0;var i=n(2237);Object.defineProperty(t,"Equalizer",{enumerable:!0,get:function(){return i.Equalizer}}),Object.defineProperty(t,"AudioContextWithMethod",{enumerable:!0,get:function(){return i.AudioContextWithMethod}});var a=n(55);Object.defineProperty(t,"usefulFilfter",{enumerable:!0,get:function(){return a.usefulFilfter}});var r=n(1302);Object.defineProperty(t,"Store",{enumerable:!0,get:function(){return r.Store}});var o=n(2079);Object.defineProperty(t,"hzToTitle",{enumerable:!0,get:function(){return o.hzToTitle}}),Object.defineProperty(t,"getCurrentTabs",{enumerable:!0,get:function(){return o.getCurrentTabs}}),Object.defineProperty(t,"sendMessageToCurrentTabs",{enumerable:!0,get:function(){return o.sendMessageToCurrentTabs}}),Object.defineProperty(t,"sendMessageToEuqalizer",{enumerable:!0,get:function(){return o.sendMessageToEuqalizer}})},1302:function(e,t){var n=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,r){function o(e){try{u(i.next(e))}catch(e){r(e)}}function s(e){try{u(i.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Store=void 0,t.Store=class{static getAll(){return n(this,void 0,void 0,(function*(){return yield browser.storage.local.get()}))}static get(e){return n(this,void 0,void 0,(function*(){return yield browser.storage.local.get(e).then((t=>t[e]))}))}static set(e,t){return n(this,void 0,void 0,(function*(){return browser.storage.local.set({[e]:t})}))}static clearAll(){return browser.storage.local.set({})}}},2079:function(e,t){var n=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,r){function o(e){try{u(i.next(e))}catch(e){r(e)}}function s(e){try{u(i.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((i=i.apply(e,t||[])).next())}))};function i(){return n(this,void 0,void 0,(function*(){return yield browser.tabs.query({active:!0,currentWindow:!0})}))}Object.defineProperty(t,"__esModule",{value:!0}),t.sendMessageToEuqalizer=t.sendMessageToCurrentTabs=t.getCurrentTabs=t.hzToTitle=void 0,t.hzToTitle=function(e){return e>=1e3?e/1e3+"K HZ":`${e} HZ`},t.getCurrentTabs=i,t.sendMessageToCurrentTabs=function(e,t){return n(this,void 0,void 0,(function*(){var n;const a=yield i();browser.tabs.sendMessage(null!==(n=a[0].id)&&void 0!==n?n:0,{type:e,data:t})}))},t.sendMessageToEuqalizer=function(e,t){return n(this,void 0,void 0,(function*(){browser.runtime.sendMessage({type:e,data:t})}))}}},t={};function n(i){var a=t[i];if(void 0!==a)return a.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,n),r.exports}(()=>{n(8153),n(640),n(4595);const e=n(5464),t=n(2857),i=n(5243);browser.runtime.onMessage.addListener(((t,n)=>{switch(t.type){case"initUI":{const{fliter:n,isAutoConnect:a}=t.data;e.SliderArray.forEach(((e,t)=>{e.value=n[t].gain})),i.auto_connect_btn.selected=a;break}case"rerender":{const{module:n,name:i}=t.data;(0,e.rerenderSelect)("filter-select-add"===n?i:void 0);break}default:console.log("debug",t)}})),(0,t.sendMessageToCurrentTabs)("open",null)})()})();